        # Wait for the refresh to complete by polling the status
        while true; do
            STATUS=$(aws autoscaling describe-instance-refreshes \
                --region ${REGION} \
                --auto-scaling-group-name ${ASG_NAME} \
                --instance-refresh-ids ${REFRESH_ID} \
                --query "InstanceRefreshes[0].Status" \
                --output text)

            echo "Current refresh status for ASG: ${ASG_NAME} is ${STATUS}"

            if [ "$STATUS" == "Successful" ]; then
                echo "Instance refresh completed successfully for ASG: ${ASG_NAME}"
                break
            elif [ "$STATUS" == "Failed" ]; then
                echo "Instance refresh failed for ASG: ${ASG_NAME}"
                exit 1
            else
                echo "Instance refresh in progress for ASG: ${ASG_NAME}, waiting..."
                sleep 30  # Wait for 30 seconds before checking the status again
            fi
        done
