@startuml
actor User
actor "Nginx Proxy" as Nginx

entity "Vault Agent" as VaultAgent
entity "MTLS Cert Path" as CertPath
entity "Safer Payment Cluster" as PaymentCluster

User -> Nginx: Sends Request

Nginx -> PaymentCluster: Forward Request with mTLS
PaymentCluster -> CertPath: Retrieve mTLS Cert and Key

VaultAgent -> Vault: Fetch mTLS Certs
Vault -> VaultAgent: Return mTLS Certs
VaultAgent -> CertPath: Render and Store/Update mTLS Certs

PaymentCluster -> PaymentCluster: Initialize Service with mTLS Enabled

User -> Nginx: End-to-end Communication mTLS Trusted and Encrypted

@enduml
