Issue Summary:
A potential conflict arises between two critical processes – the truncation timer job and the rehydration job – which both rely on mTLS user certificates temporarily staged in the /tmp directory. This conflict can cause issues during certain operations, leading to a need for manual intervention.

Truncation Timer Job:

Initially configured a year ago, set to run between 6 AM and 6 PM using a randomized timer (12-hour window).
This job renders and stages the mTLS user certificate in the /tmp directory during its operation.
Rehydration Job:

This job triggers the node quiescing process and an assessment memory dump.
It also uses the mTLS user certificate, which is temporarily staged in the same /tmp directory.
Problem Description:
During the rehydration process (while node quiescing and assessment memory dump are in progress), if the truncation timer job concurrently runs and renders a new certificate, it may attempt to delete the previous temporary certificates from the /tmp directory.

Due to ongoing use of these certificates by the rehydration job, this removal process may fail, leaving the node in a compromised state that requires manual recovery.

Proposed Solutions:
Timer Adjustment:

Reschedule the truncation timer job to run during the night (starting at 2 AM), reducing overlap with critical processes triggered by the rehydration job.
Separation of Temporary Certificate Locations:

Update the pipeline configuration to stage certificates in separate temporary locations, ensuring that the truncation timer job and rehydration job do not overwrite each other’s certificates in the /tmp directory.
Workaround:
In case this issue occurs in production, the following steps can be used to recover:

Remove Temporary Certificates: Manually delete the leftover certificate files from the /tmp directory.
Reset Consul KV Store: Perform a reset of the Consul KV store for Aerospike ASG refresh and assessment updates.
