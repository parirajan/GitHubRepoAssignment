Feature Description:
Enhance the deployment of the Safer Payment application by ensuring each instance in the 6-node cluster has a persistent EBS volume. These volumes should be provisioned in the same Availability Zones (AZs) as the instances to avoid cross-AZ data transfer costs and latency. Additionally, implement a startup script that attaches, formats (if needed), and mounts these EBS volumes based on instance and disk tags, ensuring the correct volume is always attached to the correct instance.

Acceptance Criteria:
Persistent EBS Volumes:

Each instance in the 6-node cluster must have an associated persistent EBS volume.
EBS volumes must be created and managed using Terraform.
Each EBS volume must be placed in the same AZ as its corresponding instance.
Startup Script:

A startup script must be created to run during the instance launch.
The script should attach the correct EBS volume to the instance based on instance and volume tags.
The script should check if the attached EBS volume is formatted:
If not formatted, the script should format the volume, create the file system, and mount it.
If already formatted, the script should mount the volume directly.
Tagging and Validation:

Each instance and EBS volume must have unique tags to ensure correct association.
The startup script must validate that the attached disk is the correct one based on the tags.
The tag association must be maintained throughout the lifecycle of the cluster, ensuring consistency during reboots or instance replacements.
Terraform Code Quality:

Terraform code must include configurations for creating and tagging EBS volumes.
Code must follow best practices, ensuring modularity and reusability.
Documentation must be provided for the Terraform code, explaining the tagging strategy and the startup script.
Testing and Validation:

Perform end-to-end testing to ensure EBS volumes are correctly created, tagged, and associated with instances.
Validate the startup scriptâ€™s functionality to correctly attach, format (if needed), and mount the EBS volumes.
Test the resiliency of the tagging mechanism to ensure correct volume-instance association during various lifecycle events.
Tasks:
Terraform Configuration:

Define Terraform configurations for creating EBS volumes and attaching them to instances.
Ensure volumes are created in the same AZs as their corresponding instances.
Implement tagging for both instances and volumes to establish the correct associations.
Startup Script Development:

Write a startup script that runs on instance launch.
The script should:
Retrieve the instance and volume tags.
Attach the correct volume to the instance.
Check if the volume is formatted and, if not, format it and create the file system.
Mount the volume to a predefined mount point.
Ensure the script validates the volume-instance association based on tags.
Testing and Validation:

Deploy the infrastructure using Terraform and validate the creation of EBS volumes.
Test the startup script by launching instances and ensuring the volumes are correctly attached, formatted (if needed), and mounted.
Validate the tagging mechanism by simulating instance reboots and replacements, ensuring the correct volumes are always associated with the correct instances.
Documentation:

Document the Terraform configurations, tagging strategy, and startup script.
Provide clear guidelines for future maintenance and scaling of the EBS volumes and instances.
By meeting these acceptance criteria, the Safer Payment application will have a robust setup where each instance is consistently associated with a persistent EBS volume, ensuring data integrity and availability across the cluster's lifecycle.
